<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dream OS — Distribute</title>
  <link rel="stylesheet" href="dreamos.css">

  <style>
    /* ===== Page layout ===== */
    .content{ margin-top: 14px; }

    .dist-grid{
      display:grid;
      grid-template-columns: 1.05fr 0.95fr;
      gap: 14px;
      align-items:start;
    }
    @media (max-width: 980px){
      .dist-grid{ grid-template-columns: 1fr; }
    }

    /* ===== Field styling (same family as login/new collection) ===== */
    .field{
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.03);
      border-radius: 16px;
      padding: 12px;
      display:flex;
      flex-direction:column;
      gap: 8px;
    }
    .label{
      font-size: 11px;
      letter-spacing:.10em;
      text-transform: uppercase;
      color: var(--muted2);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .hint{
      font-family: var(--mono);
      font-size: 11px;
      color: rgba(255,255,255,0.35);
      letter-spacing: .02em;
      text-transform:none;
    }
    input, textarea, select{
      width:100%;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.02);
      border-radius: 14px;
      padding: 10px 12px;
      color: var(--text);
      outline:none;
      font-size: 14px;
      font-family: var(--sans);
    }
    textarea{ min-height: 90px; resize: vertical; }

    .two{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 520px){
      .two{ grid-template-columns: 1fr; }
    }

    /* ===== Connectors grid ===== */
    .connectors{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 12px;
    }
    @media (max-width: 520px){
      .connectors{ grid-template-columns: 1fr; }
    }

    .connector{
      border: 1px solid rgba(255,255,255,0.08);
      background: rgba(255,255,255,0.02);
      border-radius: 18px;
      padding: 14px;
      box-shadow: 0 18px 60px rgba(0,0,0,0.28);
      display:flex;
      flex-direction:column;
      gap: 10px;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    .connector:hover{
      transform: translateY(-1px);
      border-color: rgba(180,207,106,0.28);
      background: rgba(180,207,106,0.05);
    }

    .cTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }
    .cBrand{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width:0;
    }
    .cIcon{
      width: 40px;
      height: 40px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.12);
      background:
        radial-gradient(380px 160px at 35% 30%, rgba(180,207,106,0.16), transparent 65%),
        rgba(255,255,255,0.03);
      display:flex;
      align-items:center;
      justify-content:center;
      color: rgba(255,255,255,0.82);
    }
    .cIcon svg{ width: 18px; height: 18px; stroke: rgba(255,255,255,0.86); }

    .cName{
      display:flex;
      flex-direction:column;
      gap: 2px;
      min-width:0;
    }
    .cName strong{
      color: var(--text-2);
      font-size: 13px;
      font-weight: 950;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .cName span{
      color: rgba(255,255,255,0.42);
      font-size: 11px;
      font-family: var(--mono);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .statusPill{
      font-family: var(--mono);
      font-size: 11px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.02);
      color: rgba(255,255,255,0.65);
      flex: 0 0 auto;
    }
    .statusPill.on{
      border-color: rgba(180,207,106,0.45);
      background: rgba(180,207,106,0.10);
      color: rgba(255,255,255,0.85);
    }
    .statusPill.soon{
      border-color: rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.02);
      color: rgba(255,255,255,0.45);
    }

    .cBody{
      color: var(--muted);
      font-size: 12px;
      line-height: 1.55;
    }

    .cActions{
      display:flex;
      gap: 10px;
      margin-top: 2px;
    }
    .cActions .btn{
      flex: 1;
      justify-content:center;
      width:auto;
    }
    @media (max-width: 520px){
      .cActions{ flex-direction:column; }
      .cActions .btn{ width:100%; }
    }

    /* ===== Queue list ===== */
    .queue{
      display:flex;
      flex-direction:column;
      gap: 10px;
    }
    .qItem{
      border: 1px solid rgba(255,255,255,0.08);
      background: rgba(255,255,255,0.02);
      border-radius: 16px;
      padding: 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    .qItem:hover{
      transform: translateY(-1px);
      border-color: rgba(180,207,106,0.28);
      background: rgba(180,207,106,0.05);
    }
    .qLeft{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap: 4px;
    }
    .qTitle{
      font-weight: 950;
      color: var(--text-2);
      font-size: 13px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .qMeta{
      font-family: var(--mono);
      font-size: 11px;
      color: rgba(255,255,255,0.45);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .qRight{
      display:flex;
      align-items:center;
      gap: 8px;
      flex: 0 0 auto;
    }

    .iconBtn{
      width: 38px; height: 38px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.03);
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      transition: transform .12s ease, border-color .12s ease, background .12s ease;
    }
    .iconBtn:hover{
      transform: translateY(-1px);
      border-color: var(--stroke-2);
      background: rgba(255,255,255,0.05);
    }
    .iconBtn svg{ width: 18px; height: 18px; stroke: rgba(255,255,255,0.80); }

    /* ===== Primary action row ===== */
    .mintActions{
      margin-top: 10px;
      display:flex;
      gap: 10px;
    }
    .mintActions .btn{ flex: 1; justify-content:center; }
    @media (max-width: 520px){
      .mintActions{ flex-direction:column; }
      .mintActions .btn{ width:100%; }
    }

    /* ===== Review (collapsible Mint Summary, pre-queue) ===== */
    .review{
    border: 1px solid rgba(255,255,255,0.08);
    background: rgba(255,255,255,0.02);
    border-radius: 18px;
    overflow:hidden;
    }

    .reviewToggle{
    width:100%;
    padding: 12px 12px;
    border:0;
    background: transparent;
    color: inherit;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap: 12px;
    cursor:pointer;
    }

    .reviewLeft{
    display:flex;
    align-items:center;
    gap: 10px;
    min-width:0;
    }
    .reviewTitle{
    font-weight: 950;
    color: var(--text-2);
    font-size: 13px;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
    }
    .reviewRight{
    display:flex;
    align-items:center;
    gap: 10px;
    flex: 0 0 auto;
    }
    .reviewHint{
    font-family: var(--mono);
    font-size: 11px;
    color: rgba(255,255,255,0.45);
    white-space:nowrap;
    }
    .chev{
    font-family: var(--mono);
    opacity: .7;
    transition: transform .12s ease, opacity .12s ease;
    }
    .review.open .chev{
    transform: rotate(180deg);
    opacity: 1;
    }

    .reviewBody{
    padding: 12px;
    border-top: 1px solid rgba(255,255,255,0.08);
    display:flex;
    flex-direction:column;
    gap: 12px;
    }

    /* Reuse-able summary styles (same as earlier) */
    .summaryCard{
    border: 1px solid rgba(255,255,255,0.08);
    background: rgba(255,255,255,0.02);
    border-radius: 18px;
    padding: 12px;
    display:flex;
    flex-direction:column;
    gap: 10px;
    box-shadow: 0 18px 60px rgba(0,0,0,0.25);
    }
    .sumRow{ display:flex; align-items:center; justify-content:space-between; gap: 12px; }
    .sumK{
    font-size: 11px;
    letter-spacing:.10em;
    text-transform: uppercase;
    color: rgba(255,255,255,0.42);
    }
    .sumV{
    font-family: var(--mono);
    font-size: 12px;
    color: rgba(255,255,255,0.82);
    text-align:right;
    max-width: 58%;
    overflow:hidden;
    text-overflow:ellipsis;
    white-space:nowrap;
    }
    .sumDivider{ height: 1px; background: rgba(255,255,255,0.07); margin: 2px 0; }

    /* Checks list (reused) */
    .checks{
    border: 1px solid rgba(255,255,255,0.08);
    background: rgba(255,255,255,0.02);
    border-radius: 18px;
    padding: 12px;
    font-size: 12px;
    line-height: 1.65;
    }
    .checkItem{
    font-family: var(--mono);
    font-size: 11px;
    color: rgba(255,255,255,0.55);
    }
    .checkItem.ok{ color: rgba(180,207,106,0.86); }
    .checkItem.bad{ color: rgba(255,255,255,0.40); }

    /* Fees + validate styles (if you don't already have them from earlier) */
    .fees{
    border: 1px solid rgba(255,255,255,0.08);
    background: rgba(255,255,255,0.02);
    border-radius: 18px;
    padding: 12px;
    }
    .feesTop{ display:flex; align-items:center; justify-content:space-between; gap: 10px; margin-bottom: 10px; }
    .feesTitle{ font-weight: 950; color: var(--text-2); font-size: 13px; }
    .badgeMini{
    font-family: var(--mono);
    font-size: 11px;
    color: rgba(255,255,255,0.55);
    border: 1px solid rgba(255,255,255,0.10);
    background: rgba(255,255,255,0.02);
    padding: 6px 10px;
    border-radius: 999px;
    }
    .feesGrid{ display:grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    @media (max-width: 520px){ .feesGrid{ grid-template-columns: 1fr; } }
    .feeBox{ border: 1px solid rgba(255,255,255,0.08); background: rgba(255,255,255,0.02); border-radius: 16px; padding: 10px; }
    .feeK{ font-size: 11px; letter-spacing:.10em; text-transform: uppercase; color: rgba(255,255,255,0.42); margin-bottom: 6px; }
    .feeV{ font-family: var(--mono); font-size: 12px; color: rgba(255,255,255,0.82); }
    .feesNote{ margin-top: 10px; color: var(--muted); font-size: 12px; line-height: 1.5; }

    .validateActions{ display:flex; gap: 10px; }
    .validateActions .btn{ flex: 1; justify-content:center; }
    @media (max-width: 520px){
    .validateActions{ flex-direction:column; }
    .validateActions .btn{ width:100%; }
    }


  </style>
</head>

<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <div class="orb"></div>
        <div class="brandText">
          <strong>Dream OS</strong>
          <span>Internal studio console</span>
        </div>
      </div>

      <nav class="nav" aria-label="Primary">
        <a href="dashboard.html"><span>Dashboard</span><small>01</small></a>
        <a href="new_artwork.html"><span>Create</span><small>02</small></a>
        <a href="new_collection.html"><span>Collections</span><small>03</small></a>
        <a class="active" href="distribute.html"><span>Distribute</span><small>04</small></a>
      </nav>

      <div class="sidebar-footer">
        <button class="logout-btn" type="button" onclick="alert('Hook logout');">
          <span>Logout</span><small>Esc</small>
        </button>
      </div>
    </aside>

    <!-- Scrim for mobile -->
    <div class="scrim" id="scrim" onclick="toggleSidebar(false)"></div>

    <!-- Main -->
    <main class="main">
      <!-- Topbar -->
      <div class="topbar">
        <div class="topLeft">
          <button class="burger" id="burger" aria-label="Open menu" onclick="toggleSidebar()">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M5 7h14M5 12h14M5 17h14" stroke-width="1.8" stroke-linecap="round"/>
            </svg>
          </button>

          <div class="crumbs">
            <div class="kicker">Distribution</div>
            <div class="title">Connect · Mint · Publish</div>
          </div>
        </div>

        <div class="topRight">
          <div class="pill">Build: v0.1</div>
          <button class="btn primary" type="button" onclick="alert('Hook: open mint queue');">
            <span class="dot"></span>Queue
          </button>
        </div>
      </div>

      <div class="content">

        <!-- CONNECTORS -->
        <!-- RIGHT: Mint Summary (sticky) + Queue -->
        <div class="right-stack">

        <!-- Sticky Mint Summary -->
        <section class="panel stickySummary">
            <div class="head">
            <h2>Mint Summary</h2>
            <div class="pill" id="readyPill">blocked</div>
            </div>

            <div class="body summaryBody">
            <div class="summaryCard">
                <div class="sumRow">
                <div class="sumK">Marketplace</div>
                <div class="sumV" id="sumMarket">xrpcafe</div>
                </div>
                <div class="sumRow">
                <div class="sumK">Chain</div>
                <div class="sumV" id="sumChain">XRPL</div>
                </div>
                <div class="sumRow">
                <div class="sumK">Artwork</div>
                <div class="sumV" id="sumArtwork">Dream Agent Distilleries</div>
                </div>
                <div class="sumRow">
                <div class="sumK">Collection</div>
                <div class="sumV" id="sumCollection">None</div>
                </div>

                <div class="sumDivider"></div>

                <div class="sumRow">
                <div class="sumK">Edition</div>
                <div class="sumV" id="sumEdition">1</div>
                </div>
                <div class="sumRow">
                <div class="sumK">Royalties</div>
                <div class="sumV" id="sumRoyalties">10%</div>
                </div>
                <div class="sumRow">
                <div class="sumK">Sale type</div>
                <div class="sumV" id="sumSaleType">fixed</div>
                </div>
                <div class="sumRow">
                <div class="sumK">Price</div>
                <div class="sumV" id="sumPrice">—</div>
                </div>
            </div>

            <div class="fees">
                <div class="feesTop">
                <div class="feesTitle">Estimated fees</div>
                <div class="badgeMini" id="feesMode">placeholder</div>
                </div>
                <div class="feesGrid">
                <div class="feeBox">
                    <div class="feeK">Network</div>
                    <div class="feeV" id="feeNetwork">—</div>
                </div>
                <div class="feeBox">
                    <div class="feeK">Marketplace</div>
                    <div class="feeV" id="feeMarket">—</div>
                </div>
                </div>
                <div class="feesNote" id="feesNote">
                Connect a marketplace and run “Validate” to estimate fees.
                </div>
            </div>

            <div class="validateActions">
                <button class="btn primary" type="button" onclick="validateMint()">
                <span class="dot"></span>Validate
                </button>
                <button class="btn" type="button" onclick="alert('Hook: preview listing payload');">
                Preview
                </button>
            </div>

            <div class="checks" id="checks">
                <div class="checkItem bad">• Marketplace connected</div>
                <div class="checkItem bad">• Price present</div>
                <div class="checkItem ok">• Artwork selected</div>
                <div class="checkItem ok">• Edition valid</div>
            </div>
            </div>
        </section>

        <!-- Queue / activity -->
        <section class="panel">
            <div class="head">
            <h2>Queue</h2>
            <div class="pill">Live ops</div>
            </div>

            <div class="body">
            <div class="queue" id="queue">
                <div class="qItem">
                <div class="qLeft">
                    <div class="qTitle">The Soap Wars</div>
                    <div class="qMeta">xrpcafe · edition 1 · fixed · 125 XRP</div>
                </div>
                <div class="qRight">
                    <div class="statusPill on">ready</div>
                    <button class="iconBtn" type="button" onclick="openMintModal(this)" aria-label="Open mint details">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M9 18l6-6-6-6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    </button>
                </div>
                </div>

                <div class="qItem">
                <div class="qLeft">
                    <div class="qTitle">Dream Agent Distilleries</div>
                    <div class="qMeta">opensea · edition 1 · fixed · 0.08 ETH</div>
                </div>
                <div class="qRight">
                    <div class="statusPill">draft</div>
                    <button class="iconBtn" type="button" onclick="openMintModal(this)" aria-label="Open mint details">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M9 18l6-6-6-6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    </button>
                </div>
                </div>

                <div class="qItem">
                <div class="qLeft">
                    <div class="qTitle">Temple of Openings</div>
                    <div class="qMeta">xrpcafe · edition 10 · open edition</div>
                </div>
                <div class="qRight">
                    <div class="statusPill soon">pending</div>
                    <button class="iconBtn" type="button" onclick="openMintModal(this)" aria-label="Open mint details">
                    <svg viewBox="0 0 24 24" fill="none">
                        <path d="M9 18l6-6-6-6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    </button>
                </div>
                </div>

            </div>
            </div>
        </section>

        </div>


        <!-- MINT + QUEUE -->
        <div class="dist-grid">

          <!-- LEFT: Mint / Publish form -->
          <section class="panel">
            <div class="head">
              <h2>Mint / Publish</h2>
              <div class="pill">Draft → chain → listing</div>
            </div>

            <div class="body" style="display:flex; flex-direction:column; gap:12px;">
              <div class="field">
                <div class="label">Artwork <span class="hint">Select draft</span></div>
                <select id="artwork">
                  <option>Dream Agent Distilleries (Draft)</option>
                  <option>The Soap Wars (Draft)</option>
                  <option>Temple of Openings (Draft)</option>
                </select>
              </div>

              <div class="two">
                <div class="field">
                  <div class="label">Collection <span class="hint">Optional</span></div>
                  <select id="collection">
                    <option value="">None</option>
                    <option>War & Feast</option>
                    <option>Signals & Ascensions</option>
                    <option>Industrial Scriptures</option>
                  </select>
                </div>
                <div class="field">
                  <div class="label">Marketplace <span class="hint">Connected only</span></div>
                  <select id="market">
                    <option value="xrpcafe">XRP Café (XRPL)</option>
                    <option value="opensea">OpenSea (EVM)</option>
                  </select>
                </div>
              </div>

              <div class="two">
                <div class="field">
                  <div class="label">Edition size <span class="hint">1 = one-of-one</span></div>
                  <input id="edition" type="number" min="1" value="1" />
                </div>
                <div class="field">
                  <div class="label">Royalties % <span class="hint">EVM dependent</span></div>
                  <input id="royalties" type="number" min="0" max="25" step="0.5" value="10" />
                </div>
              </div>

              <div class="two">
                <div class="field">
                  <div class="label">Price <span class="hint">Listing</span></div>
                  <input id="price" type="text" placeholder="e.g. 125 XRP or 0.08 ETH" />
                </div>
                <div class="field">
                  <div class="label">Sale type <span class="hint">Default</span></div>
                  <select id="saleType">
                    <option value="fixed" selected>Fixed</option>
                    <option value="auction">Auction</option>
                    <option value="open">Open edition window</option>
                  </select>
                </div>
              </div>

              <div class="field">
                <div class="label">Notes <span class="hint">Internal</span></div>
                <textarea id="notes" placeholder="Collector text locked. Cover verified. Ready to mint."></textarea>
              </div>

              <!-- Review / Mint Summary (collapsible, pre-queue) -->
                <div class="review">
                <button class="reviewToggle" type="button" id="reviewToggle" aria-expanded="false" onclick="toggleReview()">
                    <div class="reviewLeft">
                    <span class="pill" id="reviewState">blocked</span>
                    <div class="reviewTitle">Review mint summary</div>
                    </div>
                    <div class="reviewRight">
                    <span class="reviewHint" id="reviewHint">Fill required fields to validate</span>
                    <span class="chev" id="reviewChev">▾</span>
                    </div>
                </button>

                <div class="reviewBody" id="reviewBody" hidden>
                    <div class="summaryCard">
                    <div class="sumRow"><div class="sumK">Marketplace</div><div class="sumV" id="rMarket">—</div></div>
                    <div class="sumRow"><div class="sumK">Chain</div><div class="sumV" id="rChain">—</div></div>
                    <div class="sumRow"><div class="sumK">Artwork</div><div class="sumV" id="rArtwork">—</div></div>
                    <div class="sumRow"><div class="sumK">Collection</div><div class="sumV" id="rCollection">None</div></div>

                    <div class="sumDivider"></div>

                    <div class="sumRow"><div class="sumK">Edition</div><div class="sumV" id="rEdition">—</div></div>
                    <div class="sumRow"><div class="sumK">Royalties</div><div class="sumV" id="rRoyalties">—</div></div>
                    <div class="sumRow"><div class="sumK">Sale type</div><div class="sumV" id="rSaleType">—</div></div>
                    <div class="sumRow"><div class="sumK">Price</div><div class="sumV" id="rPrice">—</div></div>
                    </div>

                    <div class="checks" id="reviewChecks"></div>

                    <div class="fees">
                    <div class="feesTop">
                        <div class="feesTitle">Estimated fees</div>
                        <div class="badgeMini" id="rFeesMode">placeholder</div>
                    </div>
                    <div class="feesGrid">
                        <div class="feeBox">
                        <div class="feeK">Network</div>
                        <div class="feeV" id="rFeeNetwork">—</div>
                        </div>
                        <div class="feeBox">
                        <div class="feeK">Marketplace</div>
                        <div class="feeV" id="rFeeMarket">—</div>
                        </div>
                    </div>
                    <div class="feesNote" id="rFeesNote">Run “Validate” to estimate fees.</div>
                    </div>

                    <div class="validateActions">
                    <button class="btn primary" type="button" onclick="validateReview()">
                        <span class="dot"></span>Validate
                    </button>
                    <button class="btn" type="button" onclick="toggleReview(true)">Close</button>
                    </div>
                </div>
                </div>


              <div class="mintActions">
                <button class="btn primary" type="button" onclick="queueMint()">
                  <span class="dot"></span>Add to Queue
                </button>
                <button class="btn" type="button" onclick="dryRun()">Dry run</button>
              </div>
            </div>
          </section>

          <!-- RIGHT: Queue / activity -->
          <section class="panel">
            <div class="head">
              <h2>Queue</h2>
              <div class="pill">Live ops</div>
            </div>

            <div class="body">
              <div class="queue" id="queue">
                <div class="qItem">
                  <div class="qLeft">
                    <div class="qTitle">The Soap Wars</div>
                    <div class="qMeta">xrpcafe · edition 1 · fixed · 125 XRP</div>
                  </div>
                  <div class="qRight">
                    <div class="statusPill on">ready</div>
                    <button class="iconBtn" type="button" onclick="alert('Open');" aria-label="Open">
                      <svg viewBox="0 0 24 24" fill="none">
                        <path d="M9 18l6-6-6-6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button>
                  </div>
                </div>

                <div class="qItem">
                  <div class="qLeft">
                    <div class="qTitle">Dream Agent Distilleries</div>
                    <div class="qMeta">opensea · edition 1 · fixed · 0.08 ETH</div>
                  </div>
                  <div class="qRight">
                    <div class="statusPill">draft</div>
                    <button class="iconBtn" type="button" onclick="alert('Open');" aria-label="Open">
                      <svg viewBox="0 0 24 24" fill="none">
                        <path d="M9 18l6-6-6-6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button>
                  </div>
                </div>

                <div class="qItem">
                  <div class="qLeft">
                    <div class="qTitle">Temple of Openings</div>
                    <div class="qMeta">xrpcafe · edition 10 · open edition</div>
                  </div>
                  <div class="qRight">
                    <div class="statusPill soon">pending</div>
                    <button class="iconBtn" type="button" onclick="alert('Open');" aria-label="Open">
                      <svg viewBox="0 0 24 24" fill="none">
                        <path d="M9 18l6-6-6-6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                    </button>
                  </div>
                </div>

              </div>
            </div>
          </section>

        </div>
      </div>
    </main>
  </div>

  <script>
    // Sidebar toggle (matches your burger/scrim pattern)
    function toggleSidebar(force){
      const sidebar = document.getElementById('sidebar');
      const scrim = document.getElementById('scrim');
      const burger = document.getElementById('burger');

      const willOpen = (typeof force === 'boolean') ? force : !sidebar.classList.contains('open');

      sidebar.classList.toggle('open', willOpen);
      scrim.classList.toggle('show', willOpen);
      burger.classList.toggle('active', willOpen);
    }

    // Connector stubs
    function connect(m){
      document.getElementById('st-' + m).textContent = 'connected';
      document.getElementById('st-' + m).classList.add('on');
      alert('Hook: OAuth / wallet connect for ' + m);
    }
    function disconnect(m){
      document.getElementById('st-' + m).textContent = 'not connected';
      document.getElementById('st-' + m).classList.remove('on');
      alert('Hook: revoke token for ' + m);
    }
    function manage(m){
      alert('Hook: manage connection settings for ' + m);
    }

    // Mint stubs
    function dryRun(){
      const payload = readForm();
      alert('Dry run (no mint)\n\n' + JSON.stringify(payload, null, 2));
    }

    function queueMint(){
      const payload = readForm();
      addQueueItem(payload);
      alert('Hook: POST /api/mint/queue\n\n' + JSON.stringify(payload, null, 2));
    }

    function readForm(){
      return {
        artwork: document.getElementById('artwork').value,
        collection: document.getElementById('collection').value || null,
        marketplace: document.getElementById('market').value,
        edition: document.getElementById('edition').value,
        royalties: document.getElementById('royalties').value,
        price: document.getElementById('price').value,
        saleType: document.getElementById('saleType').value,
        notes: document.getElementById('notes').value
      };
    }

    function addQueueItem(p){
      const queue = document.getElementById('queue');

      const item = document.createElement('div');
      item.className = 'qItem';
      item.innerHTML = `
        <div class="qLeft">
          <div class="qTitle">${escapeHtml(p.artwork)}</div>
          <div class="qMeta">${escapeHtml(p.marketplace)} · edition ${escapeHtml(String(p.edition))} · ${escapeHtml(p.saleType)} · ${escapeHtml(p.price || '—')}</div>
        </div>
        <div class="qRight">
          <div class="statusPill">draft</div>
          <button class="iconBtn" type="button" aria-label="Open">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M9 18l6-6-6-6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>
      `;
      queue.prepend(item);
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;')
        .replaceAll('"','&quot;')
        .replaceAll("'","&#039;");
    }
    // Map marketplaces to chain labels (UI-only)
function chainFor(market){
  if (market === 'xrpcafe') return 'XRPL';
  if (market === 'opensea') return 'EVM';
  return '—';
}

function isMarketConnected(market){
  const el = document.getElementById('st-' + market);
  if (!el) return false;
  return el.classList.contains('on'); // your "connected" class
}

function syncSummary(){
  const p = readForm();

  // summary fields
  document.getElementById('sumMarket').textContent = p.marketplace;
  document.getElementById('sumChain').textContent = chainFor(p.marketplace);

  // artwork: strip "(Draft)" for clean summary
  const cleanArtwork = (p.artwork || '').replace(/\s*\(Draft\)\s*/i,'').trim();
  document.getElementById('sumArtwork').textContent = cleanArtwork || '—';

  document.getElementById('sumCollection').textContent = p.collection || 'None';
  document.getElementById('sumEdition').textContent = p.edition || '—';
  document.getElementById('sumRoyalties').textContent = (p.royalties !== '' ? `${p.royalties}%` : '—');
  document.getElementById('sumSaleType').textContent = p.saleType || '—';
  document.getElementById('sumPrice').textContent = p.price && p.price.trim() ? p.price.trim() : '—';

  // quick readiness (soft, not blocking)
  const checks = computeChecks(p);
  renderChecks(checks);

  const readyPill = document.getElementById('readyPill');
  if (checks.ready){
    readyPill.textContent = 'ready';
    readyPill.classList.add('ready');
  } else {
    readyPill.textContent = 'blocked';
    readyPill.classList.remove('ready');
  }
}

function computeChecks(p){
  const connected = isMarketConnected(p.marketplace);
  const priceOk = !!(p.price && p.price.trim().length > 0);
  const artworkOk = !!(p.artwork && p.artwork.trim().length > 0);
  const editionNum = Number(p.edition);
  const editionOk = Number.isFinite(editionNum) && editionNum >= 1;

  // "Ready" definition can be as strict as you want
  const ready = connected && artworkOk && editionOk && (p.saleType !== 'fixed' ? true : priceOk);

  return { connected, priceOk, artworkOk, editionOk, ready };
}

function renderChecks(c){
  const wrap = document.getElementById('checks');
  wrap.innerHTML = `
    <div class="checkItem ${c.connected ? 'ok' : 'bad'}">• Marketplace connected</div>
    <div class="checkItem ${c.priceOk ? 'ok' : 'bad'}">• Price present</div>
    <div class="checkItem ${c.artworkOk ? 'ok' : 'bad'}">• Artwork selected</div>
    <div class="checkItem ${c.editionOk ? 'ok' : 'bad'}">• Edition valid</div>
  `;
}

// Validate button: fake fee estimates until backend/web3 hooks exist
function validateMint(){
  const p = readForm();
  const connected = isMarketConnected(p.marketplace);

  document.getElementById('feesMode').textContent = connected ? 'estimate' : 'placeholder';

  if (!connected){
    document.getElementById('feeNetwork').textContent = '—';
    document.getElementById('feeMarket').textContent = '—';
    document.getElementById('feesNote').textContent = 'Connect the selected marketplace to estimate fees.';
    syncSummary();
    return;
  }

  // Placeholder estimates (swap later with real calls)
  const chain = chainFor(p.marketplace);
  document.getElementById('feeNetwork').textContent = chain === 'XRPL' ? '~0.000012 XRP' : '~$4–$18 gas';
  document.getElementById('feeMarket').textContent = p.marketplace === 'xrpcafe' ? 'Marketplace fee varies' : 'Marketplace fee varies';
  document.getElementById('feesNote').textContent = 'Estimates are placeholders. Replace with real network + marketplace quote endpoints.';

  syncSummary();
}

// Wire sync to inputs
['artwork','collection','market','edition','royalties','price','saleType','notes'].forEach(id=>{
  const el = document.getElementById(id);
  if (!el) return;
  el.addEventListener('input', syncSummary);
  el.addEventListener('change', syncSummary);
});

// Make connect/disconnect update summary immediately
const _connect = connect;
connect = function(m){ _connect(m); syncSummary(); }
const _disconnect = disconnect;
disconnect = function(m){ _disconnect(m); syncSummary(); }

// Initial
syncSummary();

function chainFor(market){
  if (market === 'xrpcafe') return 'XRPL';
  if (market === 'opensea') return 'EVM';
  return '—';
}
function isMarketConnected(market){
  const el = document.getElementById('st-' + market);
  return !!(el && el.classList.contains('on'));
}

function computeChecks(p){
  const connected = isMarketConnected(p.marketplace);
  const priceOk = !!(p.price && p.price.trim().length > 0);
  const artworkOk = !!(p.artwork && p.artwork.trim().length > 0);
  const editionNum = Number(p.edition);
  const editionOk = Number.isFinite(editionNum) && editionNum >= 1;

  const fixedNeedsPrice = (p.saleType === 'fixed');
  const ready = connected && artworkOk && editionOk && (!fixedNeedsPrice || priceOk);

  return { connected, priceOk, artworkOk, editionOk, ready };
}

function renderChecks(targetId, c){
  const wrap = document.getElementById(targetId);
  wrap.innerHTML = `
    <div class="checkItem ${c.connected ? 'ok' : 'bad'}">• Marketplace connected</div>
    <div class="checkItem ${c.priceOk ? 'ok' : 'bad'}">• Price present</div>
    <div class="checkItem ${c.artworkOk ? 'ok' : 'bad'}">• Artwork selected</div>
    <div class="checkItem ${c.editionOk ? 'ok' : 'bad'}">• Edition valid</div>
  `;
}

function syncReview(){
  const p = readForm();

  // Fill summary fields
  document.getElementById('rMarket').textContent = p.marketplace || '—';
  document.getElementById('rChain').textContent = chainFor(p.marketplace);
  document.getElementById('rArtwork').textContent = (p.artwork || '—').replace(/\s*\(Draft\)\s*/i,'').trim();
  document.getElementById('rCollection').textContent = p.collection || 'None';
  document.getElementById('rEdition').textContent = p.edition || '—';
  document.getElementById('rRoyalties').textContent = (p.royalties !== '' ? `${p.royalties}%` : '—');
  document.getElementById('rSaleType').textContent = p.saleType || '—';
  document.getElementById('rPrice').textContent = (p.price && p.price.trim()) ? p.price.trim() : '—';

  const c = computeChecks(p);
  renderChecks('reviewChecks', c);

  // Header pill + hint
  const state = document.getElementById('reviewState');
  const hint = document.getElementById('reviewHint');

  if (c.ready){
    state.textContent = 'ready';
    state.style.borderColor = 'rgba(180,207,106,0.45)';
    state.style.background = 'rgba(180,207,106,0.10)';
    state.style.color = 'rgba(255,255,255,0.85)';
    hint.textContent = 'Ready to queue';
  } else {
    state.textContent = 'blocked';
    state.style.borderColor = '';
    state.style.background = '';
    state.style.color = '';
    hint.textContent = 'Fill required fields to validate';
  }
}

function toggleReview(forceClose){
  const wrap = document.querySelector('.review');
  const body = document.getElementById('reviewBody');
  const btn = document.getElementById('reviewToggle');

  const isOpen = wrap.classList.contains('open');
  const willOpen = forceClose ? false : !isOpen;

  wrap.classList.toggle('open', willOpen);
  body.hidden = !willOpen;
  btn.setAttribute('aria-expanded', String(willOpen));

  if (willOpen) syncReview();
}

function validateReview(){
  const p = readForm();
  const connected = isMarketConnected(p.marketplace);

  document.getElementById('rFeesMode').textContent = connected ? 'estimate' : 'placeholder';

  if (!connected){
    document.getElementById('rFeeNetwork').textContent = '—';
    document.getElementById('rFeeMarket').textContent = '—';
    document.getElementById('rFeesNote').textContent = 'Connect the selected marketplace to estimate fees.';
    syncReview();
    return;
  }

  // Placeholder estimates (swap later)
  const chain = chainFor(p.marketplace);
  document.getElementById('rFeeNetwork').textContent = chain === 'XRPL' ? '~0.000012 XRP' : '~$4–$18 gas';
  document.getElementById('rFeeMarket').textContent = 'Marketplace fee varies';
  document.getElementById('rFeesNote').textContent = 'Estimate placeholder. Replace with real quote calls.';
  syncReview();
}

// Wire sync to form fields
['artwork','collection','market','edition','royalties','price','saleType','notes'].forEach(id=>{
  const el = document.getElementById(id);
  if (!el) return;
  el.addEventListener('input', syncReview);
  el.addEventListener('change', syncReview);
});

function openMintModal(btn){
  const item = btn.closest('.qItem');
  if (!item) return;

  const title = item.dataset.title || item.querySelector('.qTitle')?.textContent?.trim() || '—';
  const meta  = item.dataset.meta  || item.querySelector('.qMeta')?.textContent?.trim()  || '—';

  document.getElementById('mTitle').textContent = title;
  document.getElementById('mMeta').textContent = meta;

  document.getElementById('mStatus').textContent = item.dataset.status || '—';
  document.getElementById('mMarket').textContent = item.dataset.market || '—';
  document.getElementById('mChain').textContent = item.dataset.chain || '—';
  document.getElementById('mEdition').textContent = item.dataset.edition || '—';
  document.getElementById('mRoyalties').textContent = item.dataset.royalties || '—';
  document.getElementById('mPrice').textContent = item.dataset.price || '—';
  document.getElementById('mNotes').textContent = item.dataset.notes || '—';

  const modal = document.getElementById('mintModal');
  modal.classList.add('show');
  modal.setAttribute('aria-hidden','false');
  document.body.style.overflow = 'hidden';
}

function closeMintModal(){
  const modal = document.getElementById('mintModal');
  modal.classList.remove('show');
  modal.setAttribute('aria-hidden','true');
  document.body.style.overflow = '';
}

document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') closeMintModal();
});


  </script>
</body>
</html>
